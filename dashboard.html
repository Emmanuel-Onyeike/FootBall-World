<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
Â  <title>Football World Dashboard</title>
Â  <script src="https://cdn.tailwindcss.com"></script>
Â  <link rel="stylesheet"
Â  Â  href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
Â  Â  crossorigin="anonymous" referrerpolicy="no-referrer"/>
Â  Â Â 
Â  <script src="https://js.pusher.com/8.4.0/pusher.min.js"></script>

Â  <style>
Â  Â  /* Add a custom font for a more modern feel */
Â  Â  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
Â  Â  body {
Â  Â  Â  background: linear-gradient(135deg, #0f2027, #203a43, #2c5364);
Â  Â  Â  min-height: 100vh;
Â  Â  Â  font-family: 'Inter', sans-serif;
Â  Â  }
Â  Â  .glass-card {
Â  Â  Â  background: rgba(255,255,255,0.08);Â 
Â  Â  Â  backdrop-filter: blur(15px);
Â  Â  Â  border: 1px solid rgba(255,255,255,0.2);Â 
Â  Â  Â  border-radius: 1rem;
Â  Â  Â  transition: all 0.3s ease;
Â  Â  Â  box-shadow: inset 0 0 10px rgba(0,0,0,0.1);Â 
Â  Â  }
Â  Â  .glass-card:hover {
Â  Â  Â  transform: translateY(-5px);
Â  Â  Â  border-color: rgba(52, 211, 163, 0.8);Â 
Â  Â  Â  box-shadow: 0 15px 30px rgba(0,0,0,0.5);Â 
Â  Â  }
Â  Â  .live-dot {
Â  Â  Â  width: 10px; height: 10px; border-radius: 50%;
Â  Â  Â  margin-right: 6px; display: inline-block;
Â  Â  }
Â  Â  .breathing { background: #f87171; animation: pulse 1.2s infinite; }Â 
Â  Â  .stopped { background: #9ca3af; }
Â  Â  @keyframes pulse {
Â  Â  Â  0%, 100% { transform: scale(1); opacity: 1; }
Â  Â  Â  50% { transform: scale(1.4); opacity: 0.5; }
Â  Â  }
Â  </style>
</head>
<body class="text-white">

Â  <nav class="sticky top-0 z-50 bg-black/70 backdrop-blur-lg py-4 shadow-2xl">
Â  Â  <div class="container mx-auto flex flex-col md:flex-row justify-between items-center px-4 md:px-6">
Â  Â  Â  <div class="text-3xl font-extrabold text-green-400 mb-3 md:mb-0">Football World</div>
Â  Â  Â  <div class="flex flex-wrap justify-center space-x-4 sm:space-x-8 text-sm sm:text-base">
Â  Â  Â  Â  <a href="#" class="hover:text-green-400 transition py-1"><i class="fas fa-futbol"></i> Live Scores</a>
Â  Â  Â  Â  <a href="#" class="hover:text-green-400 transition py-1"><i class="fas fa-play-circle"></i> Highlights</a>
Â  Â  Â  Â  <a href="#" class="hover:text-green-400 transition py-1"><i class="fas fa-chart-line"></i> Stats</a>
Â  Â  Â  Â  <a href="#" class="hover:text-green-400 transition py-1"><i class="fas fa-newspaper"></i> News</a>
Â  Â  Â  </div>
Â  Â  </div>
Â  </nav>

Â  <main class="container mx-auto px-4 sm:px-6 py-10">
Â  Â  <h1 class="text-4xl sm:text-5xl font-extrabold text-center mb-12 bg-gradient-to-r from-green-300 to-teal-500 bg-clip-text text-transparent">
Â  Â  Â  Your Football Dashboard
Â  Â  </h1>

Â  Â  <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
Â  Â  Â Â 
Â  Â  Â  <div class="lg:col-span-2 space-y-12">
Â  Â  Â  Â Â 
Â  Â  Â  Â  <section>
Â  Â  Â  Â  Â  <h2 class="text-3xl font-bold text-green-400 mb-6 flex items-center border-b border-green-500/50 pb-2">
Â  Â  Â  Â  Â  Â  <i class="fas fa-broadcast-tower mr-3"></i> Live Scores & Upcoming
Â  Â  Â  Â  Â  </h2>
Â  Â  Â  Â  Â  <div class="grid sm:grid-cols-2 gap-6">

Â  Â  Â  Â  Â  Â  <div class="glass-card p-6 relative flex flex-col justify-between" data-match-id="match-1">
Â  Â  Â  Â  Â  Â  Â  <div class="absolute top-3 left-3 text-xs text-gray-400 flex items-center">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-trophy text-yellow-400 mr-2"></i> Copa America Final
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <span class="status absolute top-3 right-3 text-xs bg-gray-700 px-3 py-1 rounded-full flex items-center cursor-pointer hover:bg-gray-600 transition">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="live-dot stopped"></span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="status-text font-semibold">Not Started</span>
Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-between items-center mt-8 mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center flex-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="h-16 w-16 flex items-center justify-center bg-green-700/80 rounded-full mx-auto font-extrabold text-xl shadow-lg border-2 border-green-400">BRA</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="mt-2 text-lg font-medium">Brazil</p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center mx-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-4xl font-extrabold text-green-300">0 - 0</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="match-time-container text-xs mt-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="kickoff-info text-gray-300 font-semibold">Today 20:00</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="live-timer hidden mt-1 font-bold text-xl text-yellow-400"><span class="minute-text"></span></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center flex-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="h-16 w-16 flex items-center justify-center bg-sky-700/80 rounded-full mx-auto font-extrabold text-xl shadow-lg border-2 border-sky-400">ARG</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="mt-2 text-lg font-medium">Argentina</p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <button class="w-full mt-4 bg-green-600 hover:bg-green-500 transition py-2 rounded-lg text-sm font-bold shadow-md">Match Details</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="glass-card p-6 relative flex flex-col justify-between">
Â  Â  Â  Â  Â  Â  Â  <div class="absolute top-3 left-3 text-xs text-gray-400 flex items-center">
Â  Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-chess-king text-gray-300 mr-2"></i> Premier League
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <span class="status absolute top-3 right-3 text-xs bg-gray-700 px-3 py-1 rounded-full flex items-center">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="live-dot stopped"></span>
Â  Â  Â  Â  Â  Â  Â  Â  <span class="status-text font-semibold">Tomorrow</span>
Â  Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-between items-center mt-8 mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center flex-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="h-16 w-16 flex items-center justify-center bg-red-700/80 rounded-full mx-auto font-extrabold text-xl shadow-lg border-2 border-red-400">LIV</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="mt-2 text-lg font-medium">Liverpool</p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center mx-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-4xl font-extrabold text-gray-400">VS</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-xs mt-1 text-gray-300 font-semibold">14:30 GMT</div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center flex-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="h-16 w-16 flex items-center justify-center bg-blue-700/80 rounded-full mx-auto font-extrabold text-xl shadow-lg border-2 border-blue-400">MUN</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="mt-2 text-lg font-medium">Man. Utd</p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <button class="w-full mt-4 bg-gray-600 hover:bg-gray-500 transition py-2 rounded-lg text-sm font-bold shadow-md">Pre-Match Analysis</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </section>
Â  Â  Â  Â Â 
Â  Â  Â  Â  <section>
Â  Â  Â  Â  Â  <h2 class="text-3xl font-bold text-green-400 mb-6 flex items-center border-b border-green-500/50 pb-2">
Â  Â  Â  Â  Â  Â  <i class="fas fa-newspaper mr-3"></i> Recent News
Â  Â  Â  Â  Â  </h2>
Â  Â  Â  Â  Â  <div class="space-y-4">
Â  Â  Â  Â  Â  Â  <div class="glass-card p-4 flex items-center cursor-pointer">
Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-comment-dots text-green-400 text-2xl mr-4 hidden sm:block"></i>
Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  <p class="font-semibold text-lg hover:text-green-300 transition">Mbappe transfer saga concludes: joins Real Madrid on free.</p>
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-gray-400 mt-1">Transfer Rumours | 3 hours ago</p>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="glass-card p-4 flex items-center cursor-pointer">
Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-user-shield text-green-400 text-2xl mr-4 hidden sm:block"></i>
Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  <p class="font-semibold text-lg hover:text-green-300 transition">Controversial VAR decision mars title-deciding fixture.</p>
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-gray-400 mt-1">Match Review | Yesterday</p>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â <div class="glass-card p-4 flex items-center cursor-pointer">
Â  Â  Â  Â  Â  Â  Â  <i class="fas fa-first-aid text-green-400 text-2xl mr-4 hidden sm:block"></i>
Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  <p class="font-semibold text-lg hover:text-green-300 transition">Key midfielder ruled out for six weeks with hamstring injury.</p>
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-gray-400 mt-1">Injury Report | 5 hours ago</p>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </section>
Â  Â  Â  Â Â 
Â  Â  Â  </div>
Â  Â  Â Â 
Â  Â  Â  <div class="lg:col-span-1 space-y-12">
Â  Â  Â  Â Â 
Â  Â  Â  Â  <section>
Â  Â  Â  Â  Â  <h2 class="text-3xl font-bold text-green-400 mb-6 flex items-center border-b border-green-500/50 pb-2">
Â  Â  Â  Â  Â  Â  <i class="fas fa-star mr-3"></i> Top Players (Goals)
Â  Â  Â  Â  Â  </h2>
Â  Â  Â  Â  Â  <div class="space-y-3">
Â  Â  Â  Â  Â  Â  <div class="glass-card p-4 flex items-center justify-between hover:bg-white/10 cursor-pointer">
Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-xl font-bold text-green-400 mr-3">1.</span>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="h-10 w-10 bg-gray-700 rounded-full flex items-center justify-center font-bold text-sm">P10</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="ml-3">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="font-semibold">E. Haaland</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-xs text-gray-400">Man. City</p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <span class="font-extrabold text-xl">32</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="glass-card p-4 flex items-center justify-between hover:bg-white/10 cursor-pointer">
Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-xl font-bold text-gray-300 mr-3">2.</span>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="h-10 w-10 bg-gray-700 rounded-full flex items-center justify-center font-bold text-sm">P7</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="ml-3">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="font-semibold">K. MbappÃ©</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-xs text-gray-400">PSG</p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <span class="font-extrabold text-xl">28</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="glass-card p-4 flex items-center justify-between hover:bg-white/10 cursor-pointer">
Â  Â  Â  Â  Â  Â  Â  <div class="flex items-center">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-xl font-bold text-yellow-500 mr-3">3.</span>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="h-10 w-10 bg-gray-700 rounded-full flex items-center justify-center font-bold text-sm">P9</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="ml-3">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="font-semibold">R. Lewandowski</p>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-xs text-gray-400">Barcelona</p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <span class="font-extrabold text-xl">25</span>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </section>
Â  Â  Â  Â Â 
Â  Â  Â  </div>
Â  Â  </div>

Â  </main>

Â  <footer class="bg-gray-900/80 backdrop-blur-sm py-6 text-center mt-10">
Â  Â  <p class="text-gray-500 text-sm">&copy; 2025 Football World. All data is for demonstration purposes only.</p>
Â  </footer>

<script>
Â  Â  // Pusher Configuration based on your provided keys
Â  Â  const PUSHER_APP_KEY = 'cb985e78c239cf22c9f0';
Â  Â  const PUSHER_CLUSTER = 'eu';
Â  Â  const CHANNEL_NAME = 'football-world-match-1';Â 
Â  Â  const EVENT_NAME = 'state-update';
Â  Â Â 
Â  Â  // This is the endpoint for your *Serverless Function*
Â  Â  // IMPORTANT: Make sure this function is deployed!
Â  Â  const SYNC_ENDPOINT = '/api/sync-match';Â 

Â  Â  // Initialize Pusher Client
Â  Â  const pusher = new Pusher(PUSHER_APP_KEY, {
Â  Â  Â  Â  cluster: PUSHER_CLUSTER
Â  Â  });
Â  Â  const channel = pusher.subscribe(CHANNEL_NAME);
Â  Â Â 
Â  Â  const SIM_SPEED = 1000 * 4; // 4 seconds per minute

Â  Â  document.addEventListener("DOMContentLoaded", () => {

Â  Â  Â  Â  const matchId = "match-1";
Â  Â  Â  Â  const card = document.querySelector(`[data-match-id="${matchId}"]`);
Â  Â  Â  Â  if (!card) return;

Â  Â  Â  Â  const statusBtn = card.querySelector(".status");
Â  Â  Â  Â  const statusText = statusBtn.querySelector(".status-text");
Â  Â  Â  Â  const liveDot = card.querySelector(".live-dot");
Â  Â  Â  Â  const kickoffInfo = card.querySelector(".kickoff-info");
Â  Â  Â  Â  const liveTimer = card.querySelector(".live-timer");
Â  Â  Â  Â  const minuteText = card.querySelector(".minute-text");
Â  Â  Â  Â  const scoreDisplay = card.querySelector(".text-4xl.font-extrabold");

Â  Â  Â  Â  let timer;
Â  Â  Â  Â  let minute = 0;
Â  Â  Â  Â  let phase = "not-started";
Â  Â  Â  Â  let scoreHome = 0;
Â  Â  Â  Â  let scoreAway = 0;
Â  Â  Â  Â Â 
Â  Â  Â  Â  // =================================================================
Â  Â  Â  Â  // 1. LOCAL STATE MANAGEMENT
Â  Â  Â  Â  // =================================================================

Â  Â  Â  Â  function updateDisplay() {
Â  Â  Â  Â  Â  scoreDisplay.textContent = `${scoreHome} - ${scoreAway}`;
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  // CRITICAL FIX: The button is ONLY disabled during first-half and second-half
Â  Â  Â  Â  Â  // It must be enabled for not-started, half-time, and full-time to allow for action.
Â  Â  Â  Â  Â  statusBtn.style.cursor = (phase === "first-half" || phase === "second-half") ? 'default' : 'pointer';
Â  Â  Â  Â  Â  statusBtn.style.pointerEvents = (phase === "first-half" || phase === "second-half") ? 'none' : 'auto';


Â  Â  Â  Â  Â  if (phase === "first-half" || phase === "second-half") {
Â  Â  Â  Â  Â  Â  minuteText.textContent = `${minute}â€™`;
Â  Â  Â  Â  Â  Â  statusText.textContent = "LIVE";
Â  Â  Â  Â  Â  Â  liveDot.className = "live-dot breathing";
Â  Â  Â  Â  Â  Â  kickoffInfo.classList.add("hidden");
Â  Â  Â  Â  Â  Â  liveTimer.classList.remove("hidden");
Â  Â  Â  Â  Â  } else if (phase === "half-time") {
Â  Â  Â  Â  Â  Â  minuteText.textContent = "HT 45â€™";
Â  Â  Â  Â  Â  Â  statusText.textContent = "Start 2nd Half"; // Text change to prompt action
Â  Â  Â  Â  Â  Â  liveDot.className = "live-dot stopped";
Â  Â  Â  Â  Â  } else if (phase === "full-time") {
Â  Â  Â  Â  Â  Â  minuteText.textContent = "FT 90â€™";
Â  Â  Â  Â  Â  Â  statusText.textContent = "Start New Match"; // Text change for reset/new match
Â  Â  Â  Â  Â  Â  liveDot.className = "live-dot stopped";
Â  Â  Â  Â  Â  Â  kickoffInfo.classList.remove("hidden");Â 
Â  Â  Â  Â  Â  Â  liveTimer.classList.add("hidden");Â 
Â  Â  Â  Â  Â  } else if (phase === "not-started") {
Â  Â  Â  Â  Â  Â  Â minuteText.textContent = "Kickoff";
Â  Â  Â  Â  Â  Â  Â statusText.textContent = "Start Match"; // Text change to prompt action
Â  Â  Â  Â  Â  Â  Â liveDot.className = "live-dot stopped";
Â  Â  Â  Â  Â  Â  Â kickoffInfo.classList.remove("hidden");
Â  Â  Â  Â  Â  Â  Â liveTimer.classList.add("hidden");
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  function checkGoalAndBroadcast() {
Â  Â  Â  Â  Â  if (!timer) return;Â 
Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  if (Math.random() < 0.02) {Â 
Â  Â  Â  Â  Â  Â  if (Math.random() < 0.5) {
Â  Â  Â  Â  Â  Â  Â  scoreHome++;
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  scoreAway++;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  // Sync goals globally
Â  Â  Â  Â  Â  Â  sendStateToServer(phase, minute, scoreHome, scoreAway);
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  // =================================================================
Â  Â  Â  Â  // 2. SYNCHRONIZATION LOGIC (Pusher Client)
Â  Â  Â  Â  // =================================================================
Â  Â  Â  Â Â 
Â  Â  Â  Â  /** Sends the current state to the backend to be broadcast. */
Â  Â  Â  Â  function sendStateToServer(newPhase, currentMinute, homeScore, awayScore) {
Â  Â  Â  Â  Â  Â  Â const state = {
Â  Â  Â  Â  Â  Â  Â  Â  matchId: matchId,Â 
Â  Â  Â  Â  Â  Â  Â  Â  phase: newPhase,
Â  Â  Â  Â  Â  Â  Â  Â  minute: currentMinute,
Â  Â  Â  Â  Â  Â  Â  Â  scoreHome: homeScore,
Â  Â  Â  Â  Â  Â  Â  Â  scoreAway: awayScore,
Â  Â  Â  Â  Â  Â  Â  Â  timestamp: Date.now()
Â  Â  Â  Â  Â  Â  Â };
Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â fetch(SYNC_ENDPOINT, {
Â  Â  Â  Â  Â  Â  Â  Â  Â method: 'POST',
Â  Â  Â  Â  Â  Â  Â  Â  Â headers: { 'Content-Type': 'application/json' },
Â  Â  Â  Â  Â  Â  Â  Â  Â body: JSON.stringify(state)
Â  Â  Â  Â  Â  Â  Â })
Â  Â  Â  Â  Â  Â  Â .catch(error => console.error("Pusher Sync Error: Ensure your backend function is deployed at /api/sync-match.", error));
Â  Â  Â  Â  }

Â  Â  Â  Â  /** Applies a state received from Pusher and manages the local timer. */
Â  Â  Â  Â  function applyPusherState(data) {
Â  Â  Â  Â  Â  Â  // Check for and ignore redundant updates
Â  Â  Â  Â  Â  Â  if (data.minute === minute && data.phase === phase && data.scoreHome === scoreHome && data.awayScore === scoreAway) {
Â  Â  Â  Â  Â  Â  Â  Â  return;Â 
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  phase = data.phase;
Â  Â  Â  Â  Â  Â  minute = data.minute;
Â  Â  Â  Â  Â  Â  scoreHome = data.scoreHome;
Â  Â  Â  Â  Â  Â  scoreAway = data.awayScore; // Must use the server's key 'awayScore'
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (timer) clearInterval(timer);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  updateDisplay();

Â  Â  Â  Â  Â  Â  if (phase === "first-half" || phase === "second-half") {
Â  Â  Â  Â  Â  Â  Â  Â  Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â // Catch up the local minute based on the time passed since the server broadcast
Â  Â  Â  Â  Â  Â  Â  Â  Â const timeDiff = Date.now() - data.timestamp;
Â  Â  Â  Â  Â  Â  Â  Â  Â const minutesAhead = Math.floor(timeDiff / SIM_SPEED);
Â  Â  Â  Â  Â  Â  Â  Â  Â minute = Math.max(data.minute, data.minute + minutesAhead);

Â  Â  Â  Â  Â  Â  Â  Â  Â // Start the local timer tick
Â  Â  Â  Â  Â  Â  Â  Â  Â startLocalTimerTick();
Â  Â  Â  Â  Â  Â  } else if (phase === "half-time") {
Â  Â  Â  Â  Â  Â  Â  Â  // Schedule the second-half auto-start after the break period
Â  Â  Â  Â  Â  Â  Â  Â  const timeElapsedSinceBreak = Date.now() - data.timestamp;
Â  Â  Â  Â  Â  Â  Â  Â  const timeToWait = (5 * SIM_SPEED) - timeElapsedSinceBreak;
Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(startSecondHalfPusher, Math.max(0, timeToWait));
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /** Starts the local timer and handles minute-by-minute progression. */
Â  Â  Â  Â  function startLocalTimerTick() {
Â  Â  Â  Â  Â  Â  if (timer) clearInterval(timer);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  timer = setInterval(() => {
Â  Â  Â  Â  Â  Â  Â  Â  minute++;
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  checkGoalAndBroadcast();Â 

Â  Â  Â  Â  Â  Â  Â  Â  // Phase transition logic (triggers server sync)
Â  Â  Â  Â  Â  Â  Â  Â  if (minute === 45) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  clearInterval(timer);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  phase = "half-time";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sendStateToServer(phase, minute, scoreHome, scoreAway);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(startSecondHalfPusher, 5 * SIM_SPEED);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  } else if (minute === 90) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  clearInterval(timer);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  phase = "full-time";
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sendStateToServer(phase, minute, scoreHome, scoreAway);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  updateDisplay();

Â  Â  Â  Â  Â  Â  Â  Â  // Send a periodic status update (e.g., every 10 minutes)
Â  Â  Â  Â  Â  Â  Â  Â  if (minute % 10 === 0 && (phase === "first-half" || phase === "second-half")) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  sendStateToServer(phase, minute, scoreHome, scoreAway);
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  }, SIM_SPEED);Â 
Â  Â  Â  Â  }

Â  Â  Â  Â  // Helper function for half-time continue action
Â  Â  Â  Â  function startSecondHalfPusher() {
Â  Â  Â  Â  Â  Â  Â if (minute < 46) minute = 45;Â 
Â  Â  Â  Â  Â  Â  Â phase = "second-half";
Â  Â  Â  Â  Â  Â  Â minute++; // Second half starts at 46
Â  Â  Â  Â  Â  Â  Â sendStateToServer(phase, minute, scoreHome, scoreAway);
Â  Â  Â  Â  }

Â  Â  Â  Â  // =================================================================
Â  Â  Â  Â  // 3. EVENT LISTENERS AND INITIALIZATION
Â  Â  Â  Â  // =================================================================

Â  Â  Â  Â  // ðŸš¨ LISTEN FOR PUSHER UPDATES (Global Synchronization)
Â  Â  Â  Â  channel.bind(EVENT_NAME, (data) => {
Â  Â  Â  Â  Â  Â  applyPusherState(data);
Â  Â  Â  Â  });
Â  Â  Â  Â Â 
Â  Â  Â  Â  // ðŸ–±ï¸ HANDLE BUTTON CLICK (Manual Start/Half-Time Continue)
Â  Â  Â  Â  statusBtn.addEventListener("click", () => {
Â  Â  Â  Â  Â  Â  // NOTE: The statusBtn.style.pointerEvents check handles the 'disabled' state
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (phase === "not-started" || phase === "full-time") {
Â  Â  Â  Â  Â  Â  Â  Â  // This starts a new match
Â  Â  Â  Â  Â  Â  Â  Â  sendStateToServer("first-half", 1, 0, 0);
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  } else if (phase === "half-time") {
Â  Â  Â  Â  Â  Â  Â  Â  // This starts the second half
Â  Â  Â  Â  Â  Â  Â  Â  startSecondHalfPusher();
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  Â  Â Â 
Â  Â  Â  Â  // Fetch the initial state when the page loads (Persistence for new visitors)
Â  Â  Â  Â  fetch(`${SYNC_ENDPOINT}?matchId=${matchId}`)
Â  Â  Â  Â  Â  Â  .then(res => res.json())
Â  Â  Â  Â  Â  Â  .then(data => {
Â  Â  Â  Â  Â  Â  Â  Â  if (data && data.phase) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  applyPusherState(data);
Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  updateDisplay(); // Default to not-started view
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  })
Â  Â  Â  Â  Â  Â  .catch(error => {
Â  Â  Â  Â  Â  Â  Â  Â  console.error("Failed to fetch initial state. Defaulting to 'Not Started'.", error);
Â  Â  Â  Â  Â  Â  Â  Â  updateDisplay();
Â  Â  Â  Â  Â  Â  });
Â  Â  });
</script>
</body>
</html> update the enitre page 
