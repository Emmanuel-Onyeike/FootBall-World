<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Football News Hub ⚽</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        // Customizing Tailwind for a deep, modern dark theme
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dark-bg': '#0A0A0A', // Ultra Dark Background
                        'card-bg': '#1F1F1F', // Slightly lighter for cards
                        'primary': '#4CAF50', // Classic Sports Green
                        'secondary': '#81C784', // Light green accent
                        'text-light': '#F5F5F5',
                        'text-muted': '#A0A0A0',
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <style>
        .news-card {
            transition: transform 0.3s, box-shadow 0.3s, border-color 0.3s;
        }
        .news-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 25px rgba(0, 0, 0, 0.6);
            border-color: #4CAF50;
        }
        /* Hide scrollbar for aesthetics in the news feed container (Webkit browsers) */
        #scrollableNewsFeed::-webkit-scrollbar {
            display: none;
        }
        /* Hide scrollbar for aesthetics (IE and Edge) */
        #scrollableNewsFeed {
            -ms-overflow-style: none;
            /* Firefox */
            scrollbar-width: none;
        }
        /* Class for controlling the search bar visibility and animation */
        .search-bar-hidden {
            max-height: 0;
            overflow: hidden;
            padding-top: 0 !important;
            padding-bottom: 0 !important;
            opacity: 0;
            transition: max-height 0.4s ease-out, opacity 0.4s ease-out, padding 0.4s ease-out;
        }
        .search-bar-visible {
            max-height: 100px; /* Adjust based on content height */
            opacity: 1;
            transition: max-height 0.4s ease-in, opacity 0.4s ease-in, padding 0.4s ease-in;
        }
    </style>
</head>

<body class="bg-dark-bg text-text-light min-h-screen flex flex-col antialiased">

    <header class="sticky top-0 z-40 bg-card-bg border-b border-gray-800 shadow-xl">
        <div class="p-4 max-w-3xl mx-auto flex justify-between items-center">
            <h1 class="text-3xl font-extrabold tracking-wide text-primary">
                <i class="fas fa-newspaper mr-2"></i> Football News Hub
            </h1>
            <button id="searchButton" class="text-xl text-text-muted hover:text-secondary transition" title="Toggle Search">
                <i class="fas fa-search"></i>
            </button>
        </div>

        <div id="searchBar" class="search-bar-hidden px-4 pb-4 max-w-3xl mx-auto w-full">
            <div class="relative">
                <input type="text" id="searchInput" placeholder="Search news by title or content..." 
                    class="w-full bg-dark-bg text-text-light p-3 pl-10 rounded-lg border border-gray-700 focus:ring-2 focus:ring-primary focus:border-primary transition duration-150"
                    oninput="filterNews()">
                <i class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500"></i>
            </div>
        </div>
    </header>

    <div class="flex-grow max-w-3xl mx-auto w-full p-4 md:p-6 flex flex-col">

        <h2 class="text-2xl font-bold mb-4 text-text-light border-b border-gray-700 pb-2">Latest Updates</h2>
        <div id="scrollableNewsFeed" class="flex-grow overflow-y-auto space-y-6 pr-2">
            <main id="newsContainer" class="space-y-6">
                </main>

            <div id="emptyState" class="hidden text-center p-12 text-text-muted">
                <i class="fas fa-inbox text-5xl mb-4 text-gray-700"></i>
                <p class="text-lg">No news found. Be the first to post an update!</p>
            </div>
            
            <div id="noResults" class="hidden text-center p-12 text-text-muted">
                <i class="fas fa-exclamation-circle text-5xl mb-4 text-red-500"></i>
                <p class="text-lg">No results found for your search term.</p>
            </div>
        </div>
    </div>


    <button id="openModalBtn" title="Create New Post" 
        class="fixed bottom-8 right-8 bg-primary hover:bg-green-600 text-white w-16 h-16 rounded-full shadow-2xl transition duration-300 transform hover:scale-110 z-50">
        <i class="fas fa-plus text-3xl"></i>
    </button>

    <div id="modalBg" class="hidden fixed inset-0 bg-black bg-opacity-80 backdrop-blur-sm flex items-center justify-center z-50">

        <div class="bg-card-bg p-6 md:p-8 rounded-2xl shadow-2xl w-11/12 max-w-lg transform scale-100 transition-transform duration-300 ease-out border border-gray-700">
            <h2 class="text-2xl font-bold mb-6 text-center text-secondary">
                <i class="fas fa-feather-alt mr-2"></i> Create News Post
            </h2>

            <div id="imagePreviewContainer" class="hidden mb-4 rounded-lg overflow-hidden border-2 border-primary/50">
                <img id="imagePreview" src="" alt="Image Preview" class="w-full h-40 object-cover" />
            </div>

            <label for="postImage" class="block mb-2 font-semibold text-text-muted">Upload Image (Optional)</label>
            <input id="postImage" type="file" accept="image/*" class="w-full mb-4 text-text-light file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-primary/20 file:text-primary hover:file:bg-primary/30 rounded-lg p-2 transition cursor-pointer border border-gray-700" />

            <label for="postText" class="block mb-2 font-semibold text-text-muted">Write Up *</label>
            <textarea id="postText" placeholder="What's the latest scoop?" 
                class="w-full h-32 bg-dark-bg text-text-light p-4 rounded-lg border border-gray-700 focus:ring-2 focus:ring-primary focus:border-primary transition resize-none"></textarea>

            <div class="flex justify-between mt-6">
                <button id="closeModalBtn" 
                    class="bg-gray-700 text-white font-semibold px-6 py-2 rounded-full hover:bg-gray-600 transition duration-150">
                    Cancel
                </button>
                <button id="postBtn" 
                    class="bg-primary text-dark-bg font-bold px-6 py-2 rounded-full hover:bg-green-600 transition duration-150 disabled:opacity-50 disabled:cursor-not-allowed" disabled>
                    <i class="fas fa-paper-plane mr-2"></i> Post
                </button>
            </div>
        </div>
    </div>

<script>
    // --- UI Elements ---
    const searchButton = document.getElementById("searchButton");
    const searchBar = document.getElementById("searchBar");
    const searchInput = document.getElementById("searchInput");
    const openModalBtn = document.getElementById("openModalBtn");
    const modalBg = document.getElementById("modalBg");
    const closeModalBtn = document.getElementById("closeModalBtn");
    const postBtn = document.getElementById("postBtn");
    const newsContainer = document.getElementById("newsContainer");
    const postImage = document.getElementById("postImage");
    const postText = document.getElementById("postText");
    const imagePreview = document.getElementById("imagePreview");
    const imagePreviewContainer = document.getElementById("imagePreviewContainer");
    const emptyState = document.getElementById("emptyState");
    const noResults = document.getElementById("noResults");
    let allNewsCards = []; // Store all card elements for filtering

    // --- Search Bar Logic ---
    searchButton.addEventListener("click", () => {
        searchBar.classList.toggle("search-bar-hidden");
        searchBar.classList.toggle("search-bar-visible");
        if (searchBar.classList.contains("search-bar-visible")) {
            searchInput.focus();
        } else {
            searchInput.value = '';
            filterNews(); // Reset filter when search bar is closed
        }
    });

    function filterNews() {
        const query = searchInput.value.toLowerCase().trim();
        let matches = 0;

        allNewsCards.forEach(card => {
            const title = card.querySelector('h3').textContent.toLowerCase();
            const body = card.querySelector('p').textContent.toLowerCase();

            if (title.includes(query) || body.includes(query)) {
                card.style.display = 'block';
                matches++;
            } else {
                card.style.display = 'none';
            }
        });

        // Toggle No Results Message
        if (query.length > 0 && matches === 0) {
            noResults.classList.remove("hidden");
        } else {
            noResults.classList.add("hidden");
        }
        
        // Hide initial empty state if we have cards (even if they are filtered)
        if (allNewsCards.length > 0) {
            emptyState.classList.add("hidden");
        } else if (matches === 0) {
             // Only show empty state if NO news was ever loaded
            if(query.length === 0) emptyState.classList.remove("hidden");
        }
    }


    // --- Modal Logic (Unchanged) ---
    openModalBtn.addEventListener("click", () => modalBg.classList.remove("hidden"));

    function closeModal() {
        modalBg.classList.add("hidden");
        postImage.value = "";
        postText.value = "";
        imagePreview.src = "";
        imagePreviewContainer.classList.add("hidden");
        postBtn.disabled = true;
    }
    closeModalBtn.addEventListener("click", closeModal);

    function togglePostButton() {
        const filePresent = postImage.files.length > 0;
        const textPresent = postText.value.trim().length > 0;
        postBtn.disabled = !(filePresent || textPresent);
    }
    postImage.addEventListener("change", togglePostButton);
    postText.addEventListener("input", togglePostButton);

    postImage.addEventListener("change", (event) => {
        const file = event.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (e) => {
                imagePreview.src = e.target.result;
                imagePreviewContainer.classList.remove("hidden");
            };
            reader.readAsDataURL(file);
        } else {
            imagePreview.src = "";
            imagePreviewContainer.classList.add("hidden");
        }
    });

    // --- Posting Logic ---
    postBtn.addEventListener("click", () => {
        const file = postImage.files[0];
        const text = postText.value.trim();

        if (!file && !text) return;

        const reader = new FileReader();

        reader.onloadend = () => {
            const imgSrc = file ? reader.result : null;
            const postDate = new Date().toLocaleDateString('en-US', { hour: 'numeric', minute: 'numeric', day: '2-digit', month: 'short', year: 'numeric' });

            const tempDiv = document.createElement('div');
            tempDiv.innerHTML = createNewsCard({ 
                title: "User Post", 
                body: text, 
                imageUrl: imgSrc, 
                date: postDate 
            }, false);
            const newCard = tempDiv.firstChild;

            newsContainer.insertAdjacentElement("afterbegin", newCard);
            allNewsCards.unshift(newCard); // Add new card to the list for filtering

            closeModal();
            emptyState.classList.add("hidden");
            filterNews(); // Re-apply filter in case the search bar is open
        };

        if (file) reader.readAsDataURL(file);
        else reader.onloadend(); 
    });

    // --- API and News Loading Logic ---
    function createNewsCard(item, isApi = true) {
        const sourceIcon = isApi 
            ? '<i class="fas fa-globe text-xl text-red-500 mr-2"></i>'
            : '<i class="fas fa-user-circle text-xl text-secondary mr-2"></i>';
        
        const cardClass = isApi 
            ? 'border-gray-700' 
            : 'border-2 border-secondary/70 shadow-secondary/20';

        const titleColor = isApi ? 'text-primary' : 'text-secondary';
        
        const imageHtml = item.imageUrl 
            ? `<img src="${item.imageUrl}" alt="${item.title}" class="w-full h-48 object-cover rounded-xl mb-4 shadow-xl" />`
            : '';
        
        return `
            <div class="news-card bg-card-bg p-5 rounded-2xl shadow-lg ${cardClass} transition duration-300">
                ${imageHtml}
                <div class="flex items-center mb-3">
                    ${sourceIcon}
                    <span class="text-sm font-semibold text-text-muted">${isApi ? 'API News Feed' : 'Your Post'}</span>
                </div>
                <h3 class="text-xl font-extrabold mb-2 ${titleColor}">${item.title}</h3>
                <p class="text-text-light text-base leading-relaxed whitespace-pre-line">${item.body}</p>
                <div class="mt-4 flex justify-between items-center border-t border-gray-800 pt-3">
                    <a href="#" class="text-sm text-primary hover:text-white transition-colors duration-150 font-medium">Read More <i class="fas fa-arrow-right ml-1"></i></a>
                    <span class="text-xs text-gray-500">${item.date || 'Less than a minute ago'}</span>
                </div>
            </div>
        `;
    }

    async function loadNews() {
        // *** REPLACE THIS WITH YOUR ACTUAL API FETCH USING YOUR KEY ***
        const apiData = [
            { title: "Man. City Star Faces Long Layoff After Injury", body: "Scans confirm a Grade 2 hamstring tear, sidelining the winger for up to two months, a major blow to their title defence.", imageUrl: "https://images.unsplash.com/photo-1543787361-9c6a71e2330e?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D", date: "45 minutes ago" },
            { title: "Transfer Buzz: Bellingham to Liverpool Rumors Resurface", body: "Reports from Spain indicate a renewed interest from the Merseyside club as the summer window approaches. A €150M fee is being floated.", imageUrl: "https://images.unsplash.com/photo-1533083811807-6b47c0c29b6f?q=80&w=1974&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D", date: "3 hours ago" },
            { title: "Analysis: Why VAR Decisions Are Still Causing Controversy", body: "An in-depth look at the latest major incidents and calls for clearer communication protocols.", imageUrl: "", date: "1 day ago" }, 
            { title: "MLS Expansion Update: San Diego Announced as 30th Team", body: "The league confirms the new franchise will begin play in 2028 with a custom-built downtown stadium.", imageUrl: "https://images.unsplash.com/photo-1531671981881-807923f03b5f?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D", date: "2 days ago" },
        ];

        if (apiData && apiData.length > 0) {
            apiData.forEach(item => {
                const html = createNewsCard(item, true);
                newsContainer.insertAdjacentHTML("beforeend", html);
            });
            // Collect all cards into the global array for filtering
            allNewsCards = Array.from(newsContainer.children);
            emptyState.classList.add("hidden");
        } else if (newsContainer.children.length === 0) {
            emptyState.classList.remove("hidden");
        }
    }

    // Load news when the page loads
    window.addEventListener('load', loadNews);
</script>

</body>
</html>
